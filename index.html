<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CCB Amambai - Agenda</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    /* CABE√áALHO */
    .logo {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo h1 {
      font-size: 42px;
      color: #38bdf8;
      letter-spacing: 5px;
    }

    .logo p {
      color: #94a3b8;
      font-size: 18px;
    }

    /* BOT√ÉO NOTIFICA√á√ÉO - GRANDE E VIS√çVEL */
    .botao-notificacao {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      border: none;
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      width: 100%;
      box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
    }

    .botao-notificacao:hover {
      transform: scale(1.02);
    }

    .botao-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .botao-icone {
      font-size: 40px;
    }

    .botao-texto h3 {
      font-size: 20px;
      margin-bottom: 5px;
      color: white;
    }

    .botao-texto p {
      font-size: 14px;
      color: rgba(255,255,255,0.9);
    }

    .botao-seta {
      font-size: 30px;
      color: white;
    }

    /* BOT√ÉO ENVIAR LEMBRETE */
    .botao-enviar {
      background: #f59e0b;
      border: none;
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      width: 100%;
      color: white;
      font-size: 20px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .botao-enviar:hover {
      background: #d97706;
    }

    /* BANNER HOJE */
    .banner {
      background: #1e293b;
      border: 2px solid #38bdf8;
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
    }

    .banner h2 {
      color: #38bdf8;
      margin-bottom: 10px;
    }

    .banner p {
      color: #94a3b8;
    }

    /* FILTROS */
    .filtros {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .filtro {
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 25px;
      padding: 10px 20px;
      color: white;
      cursor: pointer;
    }

    .filtro.ativo {
      background: #38bdf8;
      border-color: #38bdf8;
    }

    /* DIAS */
    .dia {
      background: #1e293b;
      border-radius: 15px;
      margin: 20px 0;
      overflow: hidden;
    }

    .dia-titulo {
      background: #0f172a;
      padding: 15px 20px;
      font-size: 18px;
      font-weight: bold;
      border-bottom: 1px solid #334155;
    }

    .dia-hoje {
      color: #38bdf8;
    }

    .evento {
      padding: 15px 20px;
      border-bottom: 1px solid #334155;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .evento:last-child {
      border-bottom: none;
    }

    .evento-titulo {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .evento-local {
      color: #94a3b8;
      font-size: 13px;
    }

    .evento-tag {
      background: #38bdf8;
      color: white;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 11px;
      margin-left: 8px;
    }

    .evento-horario {
      background: #0f172a;
      padding: 8px 15px;
      border-radius: 20px;
      color: #38bdf8;
      font-weight: bold;
    }

    /* FESTAS */
    .festas {
      background: #1e293b;
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
    }

    .festas h3 {
      margin-bottom: 15px;
      color: #38bdf8;
    }

    .festa {
      padding: 10px;
      border-bottom: 1px solid #334155;
    }

    /* FAB */
    .fab {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #38bdf8;
      color: white;
      border: none;
      border-radius: 50px;
      padding: 15px 25px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(56, 189, 248, 0.3);
    }

    /* MODAL ADMIN */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-conteudo {
      background: #1e293b;
      padding: 30px;
      border-radius: 15px;
      max-width: 400px;
      width: 90%;
    }

    .modal input {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #334155;
      border-radius: 8px;
      background: #0f172a;
      color: white;
    }

    .modal button {
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    /* TOAST */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      background: #22c55e;
      color: white;
      padding: 15px 30px;
      border-radius: 50px;
      display: none;
      z-index: 1000;
    }
  </style>
</head>
<body>

  <!-- LOGO -->
  <div class="logo">
    <h1>CCB</h1>
    <p>Amambai - MS</p>
  </div>

  <!-- BOT√ÉO NOTIFICA√á√ÉO (GRANDE) -->
  <div class="botao-notificacao" onclick="ativarNotificacoes()">
    <div class="botao-info">
      <div class="botao-icone">üîî</div>
      <div class="botao-texto">
        <h3>Ativar notifica√ß√µes</h3>
        <p>Receba lembretes dos cultos</p>
      </div>
    </div>
    <div class="botao-seta">‚ñ∂</div>
  </div>

  <!-- BOT√ÉO ENVIAR LEMBRETE MANUAL -->
  <button class="botao-enviar" onclick="enviarLembreteManual()">
    <span>üì§</span> ENVIAR LEMBRETE AGORA
  </button>

  <!-- BANNER HOJE -->
  <div class="banner" id="banner">
    <h2 id="bannerTitulo">Carregando...</h2>
    <p id="bannerTexto"></p>
  </div>

  <!-- FILTROS -->
  <div class="filtros">
    <button class="filtro ativo" onclick="filtrar('todos')">üìã Todos</button>
    <button class="filtro" onclick="filtrar('hoje')">üìÖ Hoje</button>
    <button class="filtro" onclick="filtrar('semana')">üìÜ Semana</button>
  </div>

  <!-- CULTOS -->
  <div id="cultos"></div>

  <!-- FESTAS -->
  <div class="festas">
    <h3>‚≠ê Festas Espirituais</h3>
    <div id="festas"></div>
  </div>

  <!-- BOT√ÉO ADMIN -->
  <button class="fab" onclick="mostrarAdmin()">üîê ADMIN</button>

  <!-- TOAST -->
  <div class="toast" id="toast"></div>

  <!-- MODAL ADMIN -->
  <div id="modalAdmin" class="modal" style="display: none;">
    <div class="modal-conteudo">
      <h3 style="margin-bottom: 20px;">üîê Acesso Admin</h3>
      <input type="password" id="senha" placeholder="Digite a senha">
      <div style="display: flex; justify-content: flex-end;">
        <button onclick="fecharModal()">Cancelar</button>
        <button onclick="fazerLogin()" style="background: #22c55e; color: white;">Entrar</button>
      </div>
    </div>
  </div>

  <script>
    // ===== DADOS =====
    const cultos = [
      // Domingo (0)
      { dia: 0, hora: '09:30', titulo: 'Reuni√£o de Jovens', local: 'Central Amambai', regra: 'all' },
      { dia: 0, hora: '09:30', titulo: 'Reuni√£o de Jovens', local: 'Vila Cristina', regra: 'all' },
      { dia: 0, hora: '15:00', titulo: 'Culto Oficial', local: 'Aldeia Central', regra: 'all' },
      { dia: 0, hora: '15:00', titulo: 'Culto com Recitativo', local: 'Aldeia Central', regra: 'nth:1,3' },
      { dia: 0, hora: '15:00', titulo: 'Culto com Recitativos', local: 'Aldeia Central', regra: 'all' },
      { dia: 0, hora: '19:00', titulo: 'Culto com Recitativos', local: 'Vila Gl√≥ria', regra: 'all' },
      { dia: 0, hora: '19:00', titulo: 'Culto Oficial', local: 'Central Amambai', regra: 'all' },
      { dia: 0, hora: '19:00', titulo: 'Culto Oficial', local: 'Vila Cristina', regra: 'all' },
      
      // Segunda (1)
      { dia: 1, hora: '19:30', titulo: 'Culto com Recitativos', local: 'Vila Limeira', regra: 'all' },
      
      // Ter√ßa (2)
      { dia: 2, hora: '19:30', titulo: 'Culto Oficial', local: 'Vila Gl√≥ria', regra: 'all' },
      
      // Quarta (3)
      { dia: 3, hora: '19:30', titulo: 'Culto Oficial', local: 'Central Amambai', regra: 'all' },
      
      // Quinta (4)
      { dia: 4, hora: '19:30', titulo: 'Culto Oficial', local: 'Vila Limeira', regra: 'all' },
      { dia: 4, hora: '19:30', titulo: 'Culto com Ensaio', local: 'Vila Limeira', regra: 'nth:2' },
      { dia: 4, hora: '19:30', titulo: 'Culto Oficial', local: 'Aldeia Sert√£ozinho', regra: 'all' },
      { dia: 4, hora: '19:30', titulo: 'Culto com Recitativos', local: 'Aldeia Sert√£ozinho', regra: 'nth:3' },
      
      // Sexta (5)
      { dia: 5, hora: '19:30', titulo: 'Ensaio Local', local: 'Central Amambai', regra: 'nth:1' },
      { dia: 5, hora: '19:30', titulo: 'Ensaio Local', local: 'Vila Cristina', regra: 'nth:3' },
      { dia: 5, hora: '19:30', titulo: 'Ensaio Local', local: 'Vila Gl√≥ria', regra: 'nth:4' },
      
      // S√°bado (6)
      { dia: 6, hora: '09:00', titulo: 'Evangeliza√ß√£o', local: 'Pres√≠dio', regra: 'all' },
      { dia: 6, hora: '15:00', titulo: 'Evangeliza√ß√£o', local: 'Lar do Idoso', regra: 'nth:2,4' },
      { dia: 6, hora: '16:00', titulo: 'Culto Oficial', local: 'Aldeia Lim√£o Verde', regra: 'all' },
      { dia: 6, hora: '18:30', titulo: 'Culto com Recitativos', local: 'Aldeia Invernada I', regra: 'nth:2' },
      { dia: 6, hora: '19:30', titulo: 'Culto Oficial', local: 'Central Amambai', regra: 'all' }
    ];

    const festas = [
      { data: '15/03/2026', titulo: 'Santa Ceia', local: 'Central Amambai', pregador: 'Mois√©s Crepaldi' },
      { data: '22/03/2026', titulo: 'Batismo', local: 'Vila Limeira', pregador: 'Antonio Silva' },
      { data: '26/02/2026', titulo: 'Culto Mocidade', local: 'Aldeia Sert√£ozinho', pregador: 'Jo√£o Butarelli' }
    ];

    const dias = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];
    let filtroAtual = 'todos';
    let adminLogado = false;

    // ===== FUN√á√ïES PRINCIPAIS =====
    function getSemana() {
      const hoje = new Date();
      const primeiroDia = new Date(hoje.getFullYear(), hoje.getMonth(), 1);
      return Math.ceil((hoje.getDate() + primeiroDia.getDay()) / 7);
    }

    function cultosVisiveis() {
      const semana = getSemana();
      const hoje = new Date().getDay();
      
      return cultos.filter(c => {
        // Filtro de regra
        if (c.regra !== 'all') {
          const semanas = c.regra.replace('nth:', '').split(',').map(Number);
          if (!semanas.includes(semana)) return false;
        }
        
        // Filtro de per√≠odo
        if (filtroAtual === 'hoje' && c.dia !== hoje) return false;
        if (filtroAtual === 'semana') return true;
        
        return true;
      });
    }

    function renderizarCultos() {
      const cultosFiltrados = cultosVisiveis();
      const container = document.getElementById('cultos');
      let html = '';

      for (let d = 0; d < 7; d++) {
        const cultosDia = cultosFiltrados.filter(c => c.dia === d).sort((a,b) => a.hora.localeCompare(b.hora));
        if (cultosDia.length === 0 && filtroAtual !== 'semana') continue;

        const isHoje = d === new Date().getDay();
        html += `
          <div class="dia">
            <div class="dia-titulo ${isHoje ? 'dia-hoje' : ''}">
              ${dias[d]} ${isHoje ? ' (HOJE)' : ''}
            </div>
            ${cultosDia.map(c => {
              const tag = c.regra !== 'all' ? `<span class="evento-tag">${c.regra.replace('nth:', '')}¬™</span>` : '';
              return `
                <div class="evento">
                  <div>
                    <div class="evento-titulo">${c.titulo} ${tag}</div>
                    <div class="evento-local">üìç ${c.local}</div>
                  </div>
                  <div class="evento-horario">${c.hora}</div>
                </div>
              `;
            }).join('')}
          </div>
        `;
      }

      container.innerHTML = html || '<p style="text-align:center;padding:40px;">Nenhum culto encontrado</p>';
      atualizarBanner();
    }

    function renderizarFestas() {
      const container = document.getElementById('festas');
      container.innerHTML = festas.map(f => `
        <div class="festa">
          <div style="display:flex;justify-content:space-between;">
            <span><strong>${f.titulo}</strong></span>
            <span>${f.data}</span>
          </div>
          <div style="color:#94a3b8; font-size:13px;">üìç ${f.local}</div>
          <div style="color:#94a3b8; font-size:13px;">üë§ Ir. ${f.pregador}</div>
        </div>
      `).join('');
    }

    function atualizarBanner() {
      const hoje = new Date().getDay();
      const semana = getSemana();
      const cultosHoje = cultosVisiveis().filter(c => c.dia === hoje);
      
      document.getElementById('bannerTitulo').innerHTML = `üìÖ HOJE - ${dias[hoje]}`;
      
      if (cultosHoje.length === 0) {
        document.getElementById('bannerTexto').innerHTML = 'Nenhum culto hoje';
      } else {
        document.getElementById('bannerTexto').innerHTML = cultosHoje.map(c => 
          `${c.hora} - ${c.titulo}`
        ).join('<br>');
      }
    }

    function filtrar(tipo) {
      filtroAtual = tipo;
      document.querySelectorAll('.filtro').forEach(b => b.classList.remove('ativo'));
      event.target.classList.add('ativo');
      renderizarCultos();
    }

    // ===== NOTIFICA√á√ïES =====
    function ativarNotificacoes() {
      if (!('Notification' in window)) {
        alert('Seu navegador n√£o suporta notifica√ß√µes');
        return;
      }

      if (Notification.permission === 'granted') {
        toast('‚úÖ Notifica√ß√µes j√° est√£o ativadas!');
        testarNotificacao();
      } 
      else if (Notification.permission !== 'denied') {
        Notification.requestPermission().then(permission => {
          if (permission === 'granted') {
            toast('‚úÖ Notifica√ß√µes ativadas com sucesso!');
            testarNotificacao();
          } else {
            alert('‚ùå Voc√™ precisa permitir notifica√ß√µes');
          }
        });
      } else {
        alert('‚ùå Notifica√ß√µes bloqueadas. Desbloqueie nas configura√ß√µes do navegador');
      }
    }

    function testarNotificacao() {
      new Notification('üîî Teste funcionando!', {
        body: 'Notifica√ß√µes ativadas com sucesso!',
        icon: 'https://cdn-icons-png.flaticon.com/512/733/733585.png',
        vibrate: [200, 100, 200]
      });
    }

    function enviarLembreteManual() {
      if (Notification.permission !== 'granted') {
        alert('Ative as notifica√ß√µes primeiro!');
        return;
      }

      const hoje = new Date().getDay();
      const semana = getSemana();
      const cultosHoje = cultos.filter(c => c.dia === hoje).filter(c => {
        if (c.regra === 'all') return true;
        const semanas = c.regra.replace('nth:', '').split(',').map(Number);
        return semanas.includes(semana);
      });

      if (cultosHoje.length === 0) {
        toast('üì≠ Nenhum culto hoje');
        return;
      }

      const lista = cultosHoje.map(c => `‚Ä¢ ${c.hora} - ${c.titulo} (${c.local})`).join('\n');
      const versiculo = '"Porque vale mais um dia nos teus √°trios do que em outra parte mil" Salmos 84:10';

      new Notification('üìÖ Cultos de Hoje', {
        body: `${lista}\n\n${versiculo}\n\nDeus aben√ßoe!`,
        icon: 'https://cdn-icons-png.flaticon.com/512/733/733585.png',
        vibrate: [200, 100, 200],
        requireInteraction: true
      });

      toast('‚úÖ Lembrete enviado!');
    }

    // ===== ADMIN =====
    function mostrarAdmin() {
      document.getElementById('modalAdmin').style.display = 'flex';
    }

    function fecharModal() {
      document.getElementById('modalAdmin').style.display = 'none';
    }

    function fazerLogin() {
      const senha = document.getElementById('senha').value;
      if (senha === 'ccb2025') {
        adminLogado = true;
        toast('‚úÖ Modo admin ativado');
        fecharModal();
      } else {
        alert('Senha incorreta!');
      }
    }

    // ===== TOAST =====
    function toast(msg) {
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.style.display = 'block';
      setTimeout(() => t.style.display = 'none', 3000);
    }

    // ===== IR PARA HOJE =====
    function irParaHoje() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ===== INICIAR =====
    renderizarCultos();
    renderizarFestas();
  </script>
</body>
</html>
